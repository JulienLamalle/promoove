
<!-- Header -->
<section class="pt-5 bg-section-secondary">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-9">
        <div class="row align-items-center">
          <div class="col-auto">
            <!-- Avatar -->
            <%if @user.profile_picture.attached?%>
              <%= image_tag @user.profile_picture, alt:"profile picture", class:"avatar avatar-xl rounded-circle" %>
            <% else %>
              <%= image_tag "https://images.unsplash.com/photo-1599508704512-2f19efd1e35f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=675&q=80" , alt:"profile picture", class:"avatar avatar-xl rounded-circle" %>
            <% end%>
          </div>
          <div class="col ml-n3 ml-md-n2">
            <!-- Title -->
            <% if @user.first_name && @user.last_name %>
              <h2 class="h2 mb-0">
                <%= "#{@user.first_name} #{@user.last_name}" %>
              </h2>
            <% else %>
              <h2 class="h2 mb-0">
                <%= @user.email %>
              </h2>
            <% end %>
            <!-- Subtitle -->
            <% if @user.professional_background %>
              <span class="text-muted d-block">
                <%= @user.professional_background %>
              </span>
            <% end %>
          </div>
        </div>
        <div class="mt-4">
          <ul class="nav nav-tabs overflow-x">
            <li class="nav-item">
              <%= link_to "Profil", user_fr_path(@user), class:"nav-link active" %>
            </li>
            <li class="nav-item">
              <% if @user == current_user %>
                <%= link_to "Editer mon profil", edit_user_registration_path, class:"nav-link" %>
              <% end %>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="slice slice-sm bg-section-secondary">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-9 pb-4">
        <div class="row justify-content-between text-center">
          <div class="col">
            <h6 class="text-sm mb-0">
              <% if @user.github_link? %>
                <%= link_to @user.github_link, target: "_blank" do %>
                  <svg class="icon-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="2em" height="2em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77A5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></g></svg>
                <% end %>
              <% end %>
            </h6>
          </div>
          <div class="col">
            <h6 class="text-sm mb-0">
              <% if @user.gitlab_link? %>
                <%= link_to @user.gitlab_link, target: "_blank" do %>
                  <svg class="icon-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="2em" height="2em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.65 14.39L12 22.13L1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78l2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0a.42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0a.42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"/></g></svg>
                <% end %>
              <% end %>
            </h6>
          </div>
          <div class="col">
            <h6 class="text-sm mb-0">
              <% if @user.twitter_link? %>
                <%= link_to @user.twitter_link, target: "_blank" do %>
                  <svg class="icon-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="2em" height="2em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53a4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/></g></svg>
                <% end %>
              <% end %>
            </h6>
          </div>
          <div class="col">
            <h6 class="text-sm mb-0">
              <% if @user.linkedin_link? %>
                <%= link_to @user.linkedin_link, target: "_blank" do %>
                  <svg class="icon-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="2em" height="2em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><path d="M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
                <% end %>
              <% end %>
            </h6>
          </div>
        </div>
      </div>
      <div class="col-lg-9 delimiter-bottom">
        <!-- Title -->
        <% if @all_collaboration_projects.length >= 1 %>
          <div class="row align-items-center mb-3">
            <div class="col">
              <h6 class="mb-0">Projets auxquels <%= @user.first_name %> participe</h6>
            </div>
          </div>
          <div class="row">
            <% @all_collaboration_projects.each do |project_hash| %>
              <div class="col-xl-6 pt-3">
                <div class="card card-fluid">
                  <div class="card-header">
                    <div class="row align-items-center">
                      <div class="col-auto">
                        <%if @user.profile_picture.attached?%>
                          <%= image_tag @user.profile_picture, alt:"profile picture", class:"avatar avatar rounded-circle" %>
                        <% else %>
                          <%= image_tag "https://images.unsplash.com/photo-1599508704512-2f19efd1e35f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=675&q=80" , alt:"profile picture", class:"avatar avatar-xl rounded-circle" %>
                        <% end%>
                      </div>
                      <div class="col ml-md-n2">
                        <%= link_to project_hash[:project].name, project_fr_path(project_hash[:project]), class:"d-block h6 mb-0" %>
                        <small class="d-block text-muted">
                          <%= project_hash[:role].name %>
                        </small>
                      </div>
                      <div class="col-auto">
                        <button type="button" class="btn btn-xs btn-primary btn-icon rounded-pill">
                          <%= link_to "Voir plus", project_fr_path(project_hash[:project]), class:"btn-primary btn-inner--text" %>
                        </button>
                      </div>
                    </div>
                    <div class="row justify-content-left mt-2">
                      <% project_hash[:categories].each do |category| %>
                        <div class="row m-2">
                          <button type="button" class="btn btn-xs btn-secondary btn-icon rounded-pill">
                            <%= link_to category.name, category_path(category), class:"btn-secondary btn-inner--text" %>
                          </button>
                        </div>
                      <% end %>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="row-auto">
                      <%= project_hash[:project].short_description.truncate(220, omission: '...') %>
                    </div>
                  </div>
                  <div class="card-footer py-2">
                    <div class="row-auto justify-content-left">
                      <div class="row mx-n2">
                        <div class="col-auto text-center align-items-center px-2">
                          <h3 style="margin-bottom:-4px; margin-top:5px;">
                            <%= project_hash[:upvotes].size %>
                          </h3>
                          <span>votes</span>
                        </div>
                        <!-- Avatars -->
                        <% project_hash[:upvotes].take(5).map do |upvote|%>
                          <div class="col-auto text-center mb-3 px-1">
                            <%if upvote.user.profile_picture.attached?%>
                              <%= image_tag @user.profile_picture, alt:"profile picture", class:"avatar avatar-xl rounded-circle" %>
                            <% else %>
                              <%= image_tag "https://images.unsplash.com/photo-1599508704512-2f19efd1e35f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=675&q=80" , alt:"profile picture", class:"avatar rounded-circle" %>
                            <% end%>
                            <%= link_to upvote.user.first_name, user_fr_path(upvote.user), class:"d-block text-xs mt-1 stretched-link text-muted" %>
                          </div>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% elsif current_user == @user %>
          <div class="row justify-content-center py-5">
            <%= image_tag "empty_.svg", class: "animated fadeIn mb-5" %>
            <h5 class="text-white text-center">Oh oh ! On dirait que tu n'as pas encore de collaboration à afficher ici !</h5>
          </div>
        <% else  %>
        <div class="row justify-content-center py-5">
            <%= image_tag "empty_.svg", class: "animated fadeIn mb-5" %>
            <h5 class="text-white text-center">Oh oh ! On dirait que cet utilisateur pas encore de collaboration à afficher ici !</h5>
          </div>
        <% end %>
      </div>
      <div class="col-lg-9 mt-4">
        <% if @user.first_name? %>
          <h6 class="mb-0">A propos de <%= @user.first_name %></h6>
        <% else %>
          <h6 class="mb-0">A propos de <%= @user.email %></h6>
        <% end %>
        <small class="mb-0 text-muted">
          <%= "Inscrit depuis le #{@user.created_at.day}/#{@user.created_at.month}/#{@user.created_at.year}" %>
        </small>
        <% if @user.description? %>
          <p class="mt-3"><%= @user.description %></p>
        <% end %>
      </div>
    </div>
  </div>
</div>
</section>
